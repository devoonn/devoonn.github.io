<!doctype html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">


    
    <title>Love</title>

    <!-- Style Main -->
    <style>
      body{
        height: 100vh;
      }
    </style>

    <!-- Button Animation -->
    <style>
      body {
        /* font-size: 16px; */
        font-family: "Helvetica", "Arial", sans-serif;
        text-align: center;
        background-color: #f8faff;
      }

      .bubbly-button {
        font-family: "Helvetica", "Arial", sans-serif;
        display: inline-block;
        font-size: 2em;
        padding: 1em 2em;
        margin-top: 100px;
        margin-bottom: 60px;
        -webkit-appearance: none;
        appearance: none;
        background-color: #ff0081;
        color: #fff;
        border-radius: 4px;
        border: none;
        cursor: pointer;
        position: relative;
        transition: transform ease-in 0.1s, box-shadow ease-in 0.25s;
        box-shadow: 0 2px 25px rgba(255, 0, 130, 0.5);
        z-index: 2;
      }
      .bubbly-button:focus {
        outline: 0;
      }
      .bubbly-button:before, .bubbly-button:after {
        position: absolute;
        content: "";
        display: block;
        width: 140%;
        height: 100%;
        left: -20%;
        z-index: -1000;
        transition: all ease-in-out 0.5s;
        background-repeat: no-repeat;
      }
      .bubbly-button:before {
        display: none;
        top: -75%;
        background-image: radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, transparent 20%, #ff0081 20%, transparent 30%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, transparent 10%, #ff0081 15%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%);
        background-size: 10% 10%, 20% 20%, 15% 15%, 20% 20%, 18% 18%, 10% 10%, 15% 15%, 10% 10%, 18% 18%;
      }
      .bubbly-button:after {
        display: none;
        bottom: -75%;
        background-image: radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, transparent 10%, #ff0081 15%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%), radial-gradient(circle, #ff0081 20%, transparent 20%);
        background-size: 15% 15%, 20% 20%, 18% 18%, 20% 20%, 15% 15%, 10% 10%, 20% 20%;
      }
      .bubbly-button:active {
        transform: scale(0.9);
        background-color: #e60074;
        box-shadow: 0 2px 25px rgba(255, 0, 130, 0.2);
      }
      .bubbly-button.animate:before {
        display: block;
        animation: topBubbles ease-in-out 0.75s forwards;
      }
      .bubbly-button.animate:after {
        display: block;
        animation: bottomBubbles ease-in-out 0.75s forwards;
      }

      @keyframes topBubbles {
        0% {
          background-position: 5% 90%, 10% 90%, 10% 90%, 15% 90%, 25% 90%, 25% 90%, 40% 90%, 55% 90%, 70% 90%;
        }
        50% {
          background-position: 0% 80%, 0% 20%, 10% 40%, 20% 0%, 30% 30%, 22% 50%, 50% 50%, 65% 20%, 90% 30%;
        }
        100% {
          background-position: 0% 70%, 0% 10%, 10% 30%, 20% -10%, 30% 20%, 22% 40%, 50% 40%, 65% 10%, 90% 20%;
          background-size: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%;
        }
      }
      @keyframes bottomBubbles {
        0% {
          background-position: 10% -10%, 30% 10%, 55% -10%, 70% -10%, 85% -10%, 70% -10%, 70% 0%;
        }
        50% {
          background-position: 0% 80%, 20% 80%, 45% 60%, 60% 100%, 75% 70%, 95% 60%, 105% 0%;
        }
        100% {
          background-position: 0% 90%, 20% 90%, 45% 70%, 60% 110%, 75% 80%, 95% 70%, 110% 10%;
          background-size: 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%, 0% 0%;
        }
      }
    </style>
    
    <!-- Background Animation -->
    <style>
      @import "https://fonts.googleapis.com/css?family=Lato:100";
  
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
  
      html {
        font-family: "Lato", Arial, sans-serif;
      }
  
      section {
        width: 100%;
        height: 100vh;
        color: #fff;
        background: linear-gradient(-45deg, #EE7752, #E73C7E, #23A6D5, #23D5AB);
        background-size: 400% 400%;
        position: relative;
        animation: change 10s ease-in-out infinite;
      }
  
      h1 {
        font-size: 5rem;
        text-transform: uppercase;
        letter-spacing: 2px;
        border: 5px solid #fff;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        padding: 5rem 10rem;
      }
  
      @keyframes change {
        0%{
          background-position: 0 50%;
        }
  
        50%{
          background-position: 100% 50%;
        }
  
        100%{
          background-position: 0 50%;
        }
      }
    </style>

    <!-- Particle JS -->
    <style>
      body,
      html {
          height: 100%
      }

      #particles-js canvas {
          display: block;
          vertical-align: bottom;
          -webkit-transform: scale(1);
          -ms-transform: scale(1);
          transform: scale(1);
          opacity: 1;
          -webkit-transition: opacity .8s ease, -webkit-transform 1.4s ease;
          transition: opacity .8s ease, transform 1.4s ease
      }

      #particles-js {
          width: 100%;
          height: 100%;
          position: fixed;
          z-index: 1;
          top: 0;
          left: 0;
      }

    </style>
  </head>
  <body>
 

    
    
    <section>
      <div class="container h-100">
        <div class="row align-items-center h-100">
          <div class="col-6 mx-auto">
            <div class="text-center" id="center_elemen">
              <button class="bubbly-button" onclick="step1()">Click me!</button>
            </div>
          </div>
        </div>
      </div>
      <div id="particles-js"></div> 
    </section>

    




  
    <!-- Footer -->
		<footer class="page-footer font-small blue fixed-bottom">
	
			<!-- Copyright -->
			<div class="footer-copyright text-center py-3" style="color:#fff"><small> Made with
					<i class="fas fa-heart text-danger animate__animated animate__bounce animate__repeat-3 hati"></i> by
					<a target="_blank" class="text-decoration-none" style="color:#fff" id="credit"></a>@Devon</small>
			</div>
			<!-- Copyright -->
	
		</footer>
		<!-- Footer -->

    <audio autoplay loop  id="playAudio">
        <source src="https://github.com/devoonn/resource/blob/main/hbd.mp3?raw=true">
    </audio>
    

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
		<!-- Optional JavaScript; choose one of the two! -->
		<script src="https://kit.fontawesome.com/61e5120832.js" crossorigin="anonymous"></script>
	
		<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script> -->
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.8.1/dist/sweetalert2.all.min.js"></script>

    <!-- particles.js lib - https://github.com/VincentGarreau/particles.js --> 
    <script src="http://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script> 

    <!-- stats.js lib --> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r17/Stats.min.js"></script>


    <!-- Button Animation -->
    <script>
      var animateButton = function(e) {
        e.preventDefault;
        //reset animation
        e.target.classList.remove('animate');

        e.target.classList.add('animate');
        setTimeout(function(){
          e.target.classList.remove('animate');
        },700);
      };

      var bubblyButtons = document.getElementsByClassName("bubbly-button");

      for (var i = 0; i < bubblyButtons.length; i++) {
        bubblyButtons[i].addEventListener('click', animateButton, false);
      }
    </script>

    <!-- Particle JS -->
    <script>
      particlesJS('particles-js', 
        {
          "particles": {
            "number": {
              "value": 80,
              "density": {
                "enable": true,
                "value_area": 800
              }
            },
            "color": {
              "value": "#ffffff"
            },
            "shape": {
              "type": "circle",
              "stroke": {
                "width": 0,
                "color": "#000000"
              },
              "polygon": {
                "nb_sides": 5
              },
              "image": {
                "src": "img/github.svg",
                "width": 100,
                "height": 100
              }
            },
            "opacity": {
              "value": 0.5,
              "random": false,
              "anim": {
                "enable": true,
                "speed": 1,
                "opacity_min": 0.1,
                "sync": false
              }
            },
            "size": {
              "value": 30,
              "random": true,
              "anim": {
                "enable": true,
                "speed": 40,
                "size_min": 0.1,
                "sync": false
              }
            },
            "line_linked": {
              "enable": false,
              "distance": 150,
              "color": "#ffffff",
              "opacity": 0.4,
              "width": 1
            },
            "move": {
              "enable": true,
              "speed": 6,
              "direction": "none",
              "random": false,
              "straight": false,
              "out_mode": "out",
              "bounce": false,
              "attract": {
                "enable": false,
                "rotateX": 600,
                "rotateY": 1200
              }
            }
          },
          "interactivity": {
            "detect_on": "canvas",
            "events": {
              "onhover": {
                "enable": true,
                "mode": "repulse"
              },
              "onclick": {
                "enable": true,
                "mode": "push"
              },
              "resize": true
            },
            "modes": {
              "grab": {
                "distance": 400,
                "line_linked": {
                  "opacity": 1
                }
              },
              "bubble": {
                "distance": 400,
                "size": 40,
                "duration": 2,
                "opacity": 8,
                "speed": 3
              },
              "repulse": {
                "distance": 80,
                "duration": 0.4
              },
              "push": {
                "particles_nb": 4
              },
              "remove": {
                "particles_nb": 2
              }
            }
          },
          "retina_detect": true
        }
      , function() {
        console.log('callback - particles.js config loaded');
      });
    </script>

    <script>
      function playAudio() { 
				var x = document.getElementById("playAudio"); 
				x.volume = 1;
				x.play(); 
			}

      function time() {
        var d = new Date();
        var n = d.getHours();
        console.log(n);
        if (n >= 5 && n <= 10) {
          return "Pagi"
        } else if (n >= 10 && n <= 15) {
          return "Siang"
        } else if (n >= 15 && n <= 18) {
          return "Sore"
        } else if (n >= 18 && n <= 24) {
          return "Malam"
        }
      }

      function makan() {
        switch (time()) {
          case "Pagi":
          return "sarapan"
          break;
          case "Siang":
          return "makan siang"
          break;
          case "Malam":
          return "makan malam"
          break;
          case "Sore":
          return "makan"
          break;
          default:
          break;
        }
      }
    </script>

    <script>
      const url_string = document.URL;
      const url = new URL(url_string);

      var name = ''
      var phone = '';
      if (url.searchParams.get('name') != null) {
        name = url.searchParams.get('name');
      }

      function step1(){
        confetti();
        playAudio();

        Swal.fire({
          title: 'Halo '+name,
          text: `Selamat ${time()}, Kamu udah ${makan()}?`,
          showClass: { popup: 'animate__animated animate__fadeInDown' },
          hideClass: { popup: 'animate__animated animate__fadeOutUp' },
          showCancelButton: true,
          confirmButtonColor: '#3085d6',
          cancelButtonColor: '#d33',
          confirmButtonText: 'Sudah',
          cancelButtonText: 'Belum',
          allowOutsideClick: false,
        }).then((result) => {
          if (result.isConfirmed) {
            Swal.fire({
              title: 'Okedeh bagus',
              html: `Pokoknya ${name} jangan lupa makan ya, jaga diri biar selalu sehat <br><br> <button class="btn btn-primary btn-lg" onclick="step2()">Lanjut</button>`,
              showConfirmButton: false,
              allowOutsideClick: false,
            })
  
          } else {
            Swal.fire({
              title: 'Kenapa belum?',
              html: `Makan dulu ya sebelum lanjut, nih udah aku buatin mie <br><br> <button class="btn btn-primary btn-lg" onclick="step2()">Lanjut</button>`,
              imageUrl: 'https://images.unsplash.com/photo-1612929633738-8fe44f7ec841?ixlib=rb-1.2.1&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1534&q=80',
              imageAlt: 'Mie',
              showConfirmButton: false,
              allowOutsideClick: false,
            })
          }
  
        })
      }




      function step2(){
        Swal.fire({
          title: `${name} sehat sehat aja kan disana?`,
          icon: 'question',
          allowOutsideClick: false,
          showCancelButton: true,
          confirmButtonText: 'Sehat Kok',
          cancelButtonText: 'Ga Juga',
        }).then((result) => {

          if (result.isConfirmed) {
            Swal.fire({
              title: 'Bagus deh kalo gitu',
              html: `Aku disini juga sehat selalu kok hehe<br><br> <button class="btn btn-primary btn-lg" onclick="step3()">Lanjut</button>`,
              showConfirmButton: false,
              allowOutsideClick: false,
            })
  
          } else {
            Swal.fire({
              title: 'Loh emang kenapa?',
              html: `Kalo ada apa apa cerita aja, nih udh aku telpon ambulan wkwk <br><br> <button class="btn btn-primary btn-lg" onclick="step3()">Lanjut</button>`,
              imageUrl: 'https://images.unsplash.com/photo-1588543385566-413e13a51a24?ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&ixlib=rb-1.2.1&auto=format&fit=crop&w=750&q=80',
              imageAlt: 'Ambulan',
              showConfirmButton: false,
              allowOutsideClick: false,
            })
          }

        })
      }

      function step3(){
        Swal.fire({
          title: 'Oke aku mau ngomong serius nih',
          allowOutsideClick: false,
          showCancelButton: true,
          confirmButtonText: 'Apa?',
          cancelButtonText: 'Bodoamat',
        }).then((result) => {
          if (result.isConfirmed) {
            Swal.fire({
              title: 'Kepoo yaa....',
              html: `Oke klik lanjut kalo gitu <br><br> <button class="btn btn-primary btn-lg" onclick="step4()">Lanjut</button>`,
              showConfirmButton: false,
              allowOutsideClick: false,
            })
          } else {
            Swal.fire({
              title: 'Gaboleh gitu, serius ini',
              html: `Klik lanjut cepetan <br><br> <button class="btn btn-primary btn-lg" onclick="step4()">Lanjut</button>`,
              showConfirmButton: false,
              allowOutsideClick: false,
            })
          }
        })
      }


      function step4(){
        Swal.fire({
          title: 'Oke, hitung ya....',
          html: 'Satu...<br><br>Dua...<br><br>Tiga...',
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step5();
        })
      }


      function step5(){
        Swal.fire({
          title: `Perjalanan Kita Menuju Bersama`,
          text: '...',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer.jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step9();
        })
      }


      
      function step9(){
        Swal.fire({
          title: 'Awal Perjalanan',
          text: 'Semua dimulai dari momen pertama kita bertemu. Seperti sebuah petualangan, kita mulai melangkah bersama dari titik awal ini, tanpa tahu ke mana arah kita akan pergi',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(1).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step10();
        })
      }

      function step10(){
        Swal.fire({
          title: 'Momen-Momen Berharga',
          text: 'Dalam setiap langkah perjalanan kita, ada momen-momen berharga yang membentuk kisah kita. Setiap kenangan dan pengalaman yang kita lalui semakin memperkuat ikatan kita',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(2).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step11();
        })
      }

      function step11(){
        Swal.fire({
          title: 'Rintangan dan Tantangan',
          text: 'Tidak selalu perjalanan ini mulus. Ada rintangan dan tantangan yang kita hadapi bersama. Namun, setiap kesulitan membuat kita lebih kuat dan lebih dekat satu sama lain',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(3).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step12();
        })
      }

      function step12(){
        Swal.fire({
          title: 'Proses Pertumbuhan',
          text: 'Dalam perjalanan ini, kita telah tumbuh bersama. Kita telah belajar banyak tentang satu sama lain dan tentang diri kita sendiri. Setiap pengalaman membentuk kita menjadi pasangan yang lebih baik',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(4).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step13();
        })
      }

      function step13(){
        Swal.fire({
          title: 'Menuju Tujuan Bersama',
          text: 'Kini, kita sudah berada di persimpangan jalan. Dari semua perjalanan yang telah kita lalui, aku merasa saatnya untuk melangkah ke tujuan akhir kita bersama â€“ suatu tempat di mana kita bersatu dalam cinta dan komitmen',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(5).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step14();
        })
      }

      function step14(){
        Swal.fire({
          title: 'Pertanyaan Utama',
          text: 'Dengan segala cinta dan kesadaran akan perjalanan yang telah kita lalui, aku ingin bertanya... apakah kamu mau melanjutkan perjalanan ini dengan aku, menuju masa depan yang kita impikan bersama?',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(6).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step15();
        })
      }

      function step15(){
        Swal.fire({
          title: 'Penutup dan Harapan',
          text: 'Aku sangat bersyukur bisa memiliki kamu dalam perjalanan hidupku. Aku berharap kita bisa terus melangkah bersama dan mewujudkan impian kita. Terima kasih telah menjadi bagian dari setiap langkahku. Aku menantikan jawabanmu dengan penuh cinta',
          imageUrl: 'https://github.com/devoonn/resource/blob/main/confess/Designer(7).jpeg?raw=true',
          imageAlt: `${name}`,
          allowOutsideClick: false,
          confirmButtonText: 'Lanjut',
        }).then((result) => {
          step16();
        })
      }

      function step16(){
        var html = `<img src="https://github.com/devoonn/resource/blob/main/confess/Designer(8).jpeg?raw=true" alt="" class="img-fluid" width="500px">\
                    <h2>Selamat Buat ${name} atas Pertemanan Kita Sejauh Ini</h2>
                    <a href="https://devoonn.github.io/"><button class="bubbly-button" >Acara Inti!</button></a>`;
        confetti();
        $("#center_elemen").html(html);
      }

    </script>

    
    <script>

				document.querySelector('.hati').addEventListener('click', function () {
					confetti();
				})

				'use strict';

				// If set to true, the user must press
				// UP UP DOWN ODWN LEFT RIGHT LEFT RIGHT A B
				// to trigger the confetti with a random color theme.
				// Otherwise the confetti constantly falls.
				var onlyOnKonami = false;

				function confetti() {
					// Globals
					var $window = $(window),
						random = Math.random,
						cos = Math.cos,
						sin = Math.sin,
						PI = Math.PI,
						PI2 = PI * 2,
						timer = undefined,
						frame = undefined,
						confetti = [];

					var runFor = 2000
					var isRunning = true

					setTimeout(() => {
						isRunning = false
					}, runFor);

					// Settings
					var konami = [38, 38, 40, 40, 37, 39, 37, 39, 66, 65],
						pointer = 0;

					var particles = 150,
						spread = 20,
						sizeMin = 5,
						sizeMax = 12 - sizeMin,
						eccentricity = 10,
						deviation = 100,
						dxThetaMin = -.1,
						dxThetaMax = -dxThetaMin - dxThetaMin,
						dyMin = .13,
						dyMax = .18,
						dThetaMin = .4,
						dThetaMax = .7 - dThetaMin;
								
					var colorThemes = [
						function () {
							return color(200 * random() | 0, 200 * random() | 0, 200 * random() | 0);
						},
						function () {
							var black = 200 * random() | 0;
							return color(200, black, black);
						},
						function () {
							var black = 200 * random() | 0;
							return color(black, 200, black);
						},
						function () {
							var black = 200 * random() | 0;
							return color(black, black, 200);
						},
						function () {
							return color(200, 100, 200 * random() | 0);
						},
						function () {
							return color(200 * random() | 0, 200, 200);
						},
						function () {
							var black = 256 * random() | 0;
							return color(black, black, black);
						},
						function () {
							return colorThemes[random() < .5 ? 1 : 2]();
						},
						function () {
							return colorThemes[random() < .5 ? 3 : 5]();
						},
						function () {
							return colorThemes[random() < .5 ? 2 : 4]();
						}
					];

					function color(r, g, b) {
						return 'rgb(' + r + ',' + g + ',' + b + ')';
					}

					// Cosine interpolation
					function interpolation(a, b, t) {
						return (1 - cos(PI * t)) / 2 * (b - a) + a;
					}

					// Create a 1D Maximal Poisson Disc over [0, 1]
					var radius = 1 / eccentricity,
						radius2 = radius + radius;

					function createPoisson() {
						// domain is the set of points which are still available to pick from
						// D = union{ [d_i, d_i+1] | i is even }
						var domain = [radius, 1 - radius],
							measure = 1 - radius2,
							spline = [0, 1];
						while (measure) {
							var dart = measure * random(),
								i, l, interval, a, b, c, d;

							// Find where dart lies
							for (i = 0, l = domain.length, measure = 0; i < l; i += 2) {
								a = domain[i], b = domain[i + 1], interval = b - a;
								if (dart < measure + interval) {
									spline.push(dart += a - measure);
									break;
								}
								measure += interval;
							}
							c = dart - radius, d = dart + radius;

							// Update the domain
							for (i = domain.length - 1; i > 0; i -= 2) {
								l = i - 1, a = domain[l], b = domain[i];
								// c---d          c---d  Do nothing
								//   c-----d  c-----d    Move interior
								//   c--------------d    Delete interval
								//         c--d          Split interval
								//       a------b
								if (a >= c && a < d)
									if (b > d) domain[l] = d; // Move interior (Left case)
									else domain.splice(l, 2); // Delete interval
								else if (a < c && b > c)
									if (b <= d) domain[i] = c; // Move interior (Right case)
									else domain.splice(i, 0, c, d); // Split interval
							}

							// Re-measure the domain
							for (i = 0, l = domain.length, measure = 0; i < l; i += 2)
								measure += domain[i + 1] - domain[i];
						}

						return spline.sort();
					}

					// Create the overarching container
					var container = document.createElement('div');
					container.style.position = 'fixed';
					container.style.top = '0';
					container.style.left = '0';
					container.style.width = '100%';
					container.style.height = '0';
					container.style.overflow = 'visible';
					container.style.zIndex = '9999';

					// Confetto constructor
					function Confetto(theme) {
						this.frame = 0;
						this.outer = document.createElement('div');
						this.inner = document.createElement('div');
						this.outer.appendChild(this.inner);

						var outerStyle = this.outer.style,
							innerStyle = this.inner.style;
						outerStyle.position = 'absolute';
						outerStyle.width = (sizeMin + sizeMax * random()) + 'px';
						outerStyle.height = (sizeMin + sizeMax * random()) + 'px';
						innerStyle.width = '100%';
						innerStyle.height = '100%';
						innerStyle.backgroundColor = theme();

						outerStyle.perspective = '50px';
						outerStyle.transform = 'rotate(' + (360 * random()) + 'deg)';
						this.axis = 'rotate3D(' +
							cos(360 * random()) + ',' +
							cos(360 * random()) + ',0,';
						this.theta = 360 * random();
						this.dTheta = dThetaMin + dThetaMax * random();
						innerStyle.transform = this.axis + this.theta + 'deg)';

						this.x = $window.width() * random();
						this.y = -deviation;
						this.dx = sin(dxThetaMin + dxThetaMax * random());
						this.dy = dyMin + dyMax * random();
						outerStyle.left = this.x + 'px';
						outerStyle.top = this.y + 'px';

						// Create the periodic spline
						this.splineX = createPoisson();
						this.splineY = [];
						for (var i = 1, l = this.splineX.length - 1; i < l; ++i)
							this.splineY[i] = deviation * random();
						this.splineY[0] = this.splineY[l] = deviation * random();

						this.update = function (height, delta) {
							this.frame += delta;
							this.x += this.dx * delta;
							this.y += this.dy * delta;
							this.theta += this.dTheta * delta;

							// Compute spline and convert to polar
							var phi = this.frame % 7777 / 7777,
								i = 0,
								j = 1;
							while (phi >= this.splineX[j]) i = j++;
							var rho = interpolation(
								this.splineY[i],
								this.splineY[j],
								(phi - this.splineX[i]) / (this.splineX[j] - this.splineX[i])
							);
							phi *= PI2;

							outerStyle.left = this.x + rho * cos(phi) + 'px';
							outerStyle.top = this.y + rho * sin(phi) + 'px';
							innerStyle.transform = this.axis + this.theta + 'deg)';
							return this.y > height + deviation;
						};
					}


					function poof() {
						if (!frame) {
							// Append the container
							document.body.appendChild(container);

							// Add confetti

							var theme = colorThemes[onlyOnKonami ? colorThemes.length * random() | 0 : 0],
								count = 0;

							(function addConfetto() {

								if (onlyOnKonami && ++count > particles)
									return timer = undefined;

								if (isRunning) {
									var confetto = new Confetto(theme);
									confetti.push(confetto);

									container.appendChild(confetto.outer);
									timer = setTimeout(addConfetto, spread * random());
								}
							})(0);


							// Start the loop
							var prev = undefined;
							requestAnimationFrame(function loop(timestamp) {
								var delta = prev ? timestamp - prev : 0;
								prev = timestamp;
								var height = $window.height();

								for (var i = confetti.length - 1; i >= 0; --i) {
									if (confetti[i].update(height, delta)) {
										container.removeChild(confetti[i].outer);
										confetti.splice(i, 1);
									}
								}

								if (timer || confetti.length)
									return frame = requestAnimationFrame(loop);

								// Cleanup
								document.body.removeChild(container);
								frame = undefined;
							});
						}
					}

					$window.keydown(function (event) {
						pointer = konami[pointer] === event.which ?
							pointer + 1 :
							+(event.which === konami[0]);
						if (pointer === konami.length) {
							pointer = 0;
							poof();
						}
					});

					if (!onlyOnKonami) poof();
				};

    </script>

  </body>
</html>
